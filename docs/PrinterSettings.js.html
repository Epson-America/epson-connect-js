<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>PrinterSettings.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <li class="nav-link nav-home-link"><a href="index.html">Home</a></li><li class="nav-heading">Classes</li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="ApiError.html">ApiError</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="AuthContext.html">AuthContext</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="AuthContext.html#send">send</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="AuthenticationError.html">AuthenticationError</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Client.html">Client</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Client.html#deauthenticate">deauthenticate</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Client.html#initialize">initialize</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="ClientError.html">ClientError</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="PrintSettingError.html">PrintSettingError</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Printer.html">Printer</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Printer.html#cancelPrint">cancelPrint</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Printer.html#capabilities">capabilities</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Printer.html#executePrint">executePrint</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Printer.html#info">info</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Printer.html#jobInfo">jobInfo</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Printer.html#notification">notification</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Printer.html#print">print</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Printer.html#printSetting">printSetting</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Printer.html#uploadFile">uploadFile</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="PrinterError.html">PrinterError</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Scanner.html">Scanner</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Scanner.html#add">add</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Scanner.html#list">list</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Scanner.html#remove">remove</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Scanner.html#update">update</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="ScannerError.html">ScannerError</a></span></li><li class="nav-heading"><a href="global.html">Globals</a></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#generateRandomString">generateRandomString</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#mergeWithDefaultSettings">mergeWithDefaultSettings</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#validateSettings">validateSettings</a></span></li>
</nav>

<div id="main">
    
    <h1 class="page-title">PrinterSettings.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @file Provides settings and validation for the Printer.
 */

const VALID_PRINT_MODES = new Set([
    'document',
    'photo',
  ]);
  
  const VALID_MEDIA_SIZES = new Set([
    'ms_a3',
    'ms_a4',
    'ms_a5',
    'ms_a6',
    'ms_b5',
    'ms_tabloid',
    'ms_letter',
    'ms_legal',
    'ms_halfletter',
    'ms_kg',
    'ms_l',
    'ms_2l',
    'ms_10x12',
    'ms_8x10',
    'ms_hivision',
    'ms_5x8',
    'ms_postcard',
  ]);
  
  const VALID_MEDIA_TYPES = new Set([
    'mt_plainpaper',
    'mt_photopaper',
    'mt_hagaki',
    'mt_hagakiphoto',
    'mt_hagakiinkjet',
  ]);
  
  const VALID_PRINT_QUALITIES = new Set([
    'high',
    'normal',
    'draft',
  ]);
  
  const VALID_PAPER_SOURCES = new Set([
    'auto',
    'rear',
    'front1',
    'front2',
    'front3',
    'front4',
  ]);
  
  const VALID_COLOR_MODES = new Set([
    'color',
    'mono',
  ]);
  
  const VALID_TWO_SIDE = new Set([
    'none',
    'long',
    'short',
  ]);

/**
 * Generates a random alphanumeric string of a given length.
 * @param {number} length - Length of the desired random string.
 * @returns {string} Random alphanumeric string.
 */
  function generateRandomString(length) {
    const characters = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ';
    let result = '';
    for (let i = 0; i &lt; length; i++) {
      result += characters[Math.floor(Math.random() * characters.length)];
    }
    return result;
  }

/**
 * Merges provided settings with default printer settings.
 * @param {Object} [settings={}] - User-provided settings.
 * @returns {Object} Merged settings.
 */
  function mergeWithDefaultSettings(settings = {}) {
    settings.job_name = settings.job_name || `job-${generateRandomString(8)}`;
    settings.print_mode = settings.print_mode || 'document';
    
    settings.print_setting = settings.print_setting || {};
  
    // No need to check for Object.keys(printSetting).length !== 0 anymore
    const printSetting = settings.print_setting;
    
    printSetting.media_size = printSetting.media_size || 'ms_a4';
    printSetting.media_type = printSetting.media_type || 'mt_plainpaper';
    printSetting.borderless = printSetting.borderless || false;
    printSetting.print_quality = printSetting.print_quality || 'normal';
    printSetting.source = printSetting.source || 'auto';
    printSetting.color_mode = printSetting.color_mode || 'color';
    printSetting.two_sided = printSetting.two_sided || 'none';
    printSetting.reverse_order = printSetting.reverse_order || false;
    printSetting.copies = printSetting.copies || 1;
    printSetting.collate = printSetting.collate === undefined ? true : printSetting.collate;
  
    return settings;
  }
  

/**
 * Validates printer settings.
 * @param {Object} [settings={}] - Settings to be validated.
 * @throws {PrintSettingError} Throws error if settings are invalid.
 */
  function validateSettings(settings = {}) {
    const extraKeys = Object.keys(settings).filter(key => !['job_name', 'print_mode', 'print_setting'].includes(key));
    if (extraKeys.length > 0) {
      throw new PrintSettingError(`Invalid settings keys ${extraKeys.join(', ')}.`);
    }
  
    const jobName = settings.job_name;
    if (jobName.length > 256) {
      throw new PrintSettingError(`Job name is greater than 256 chars: ${jobName}`);
    }
  
    const printMode = settings.print_mode;
    if (!VALID_PRINT_MODES.has(printMode)) {
      throw new PrintSettingError(`Invalid print mode ${printMode}`);
    }
  
    const printSetting = settings.print_setting;
    if (!printSetting) {
      return;
    }
  
    // Media Size
    const mediaSize = printSetting.media_size;
    if (!VALID_MEDIA_SIZES.has(mediaSize)) {
      throw new PrintSettingError(`Invalid paper size ${mediaSize}`);
    }
  
    // media_type
    const mediaType = printSetting.media_type;
    if (!VALID_MEDIA_TYPES.has(mediaType)) {
      throw new PrintSettingError(`Invalid media type ${mediaType}`);
    }
  
    // borderless
    const borderless = printSetting.borderless;
    if (typeof borderless !== 'boolean') {
      throw new PrintSettingError('borderless must be a bool');
    }
  
    // print_quality
    const printQuality = printSetting.print_quality;
    if (!VALID_PRINT_QUALITIES.has(printQuality)) {
      throw new PrintSettingError(`Invalid print quality ${printQuality}`);
    }
  
    // Paper source
    const source = printSetting.source;
    if (!VALID_PAPER_SOURCES.has(source)) {
      throw new PrintSettingError(`Invalid source ${source}`);
    }
  
    // color_mode
    const colorMode = printSetting.color_mode;
    if (!VALID_COLOR_MODES.has(colorMode)) {
      throw new PrintSettingError(`Invalid color mode ${colorMode}`);
    }
  
    // two_sided
    const twoSided = printSetting.two_sided;
    if (!VALID_TWO_SIDE.has(twoSided)) {
      throw new PrintSettingError(`Invalid 2-sided value ${twoSided}`);
    }
  
    // reverse_order
    const reverseOrder = printSetting.reverse_order;
    if (typeof reverseOrder !== 'boolean') {
      throw new PrintSettingError('Reverse order must be a bool');
    }
  
    if (['long', 'short'].includes(twoSided) &amp;&amp; reverseOrder) {
      throw new PrintSettingError('Can not use reverse order when using two-sided printing.');
    }
  
    // copies
    const copies = printSetting.copies;
    if (copies &lt; 1 || copies > 99) {
      throw new PrintSettingError(`Invalid number of copies ${copies}`);
    }
  
    // collate
    const collate = printSetting.collate;
    if (typeof collate !== 'boolean') {
      throw new PrintSettingError('Collate must be a bool');
    }
  
    if (['long', 'short'].includes(twoSided) &amp;&amp; !collate) {
      throw new PrintSettingError('Must collate when using two-sided printing.');
    }
  }  
  
  /**
 * Error representing invalid printer settings.
 * @extends {Error}
 */
  class PrintSettingError extends Error {
    constructor(message) {
      super(message);
      this.name = 'PrintSettingError';
    }
  }
  
  module.exports = { mergeWithDefaultSettings, validateSettings, PrintSettingError };
  </code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 4.0.2</a> on Sat Oct 07 2023 14:06:48 GMT-0600 (Central Standard Time) using the Minami theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
